# パーリ語学習サイト企画

## プロジェクト概要

パーリ語の主要な経典を題材としたテキスト読解と音声読み上げを中心とした学習サイト。各単語にカタカナフリガナ、和訳、英訳を表示し、将来的にタイ語など他言語への拡張も可能な構造で実装します。ミニマルなデザインで集中して学習できる環境を提供します。

## 技術スタック

- **ランタイム**: Bun
- **フロントエンド**: Next.js 16+ (App Router) + TypeScript + Tailwind CSS
- **UIコンポーネント**: shadcn/ui
- **スタイリング**: Tailwind CSS（ミニマルデザイン）
- **音声**: Web Speech API（ブラウザネイティブ）または外部TTS API
- **データ管理**: API層を通じたデータ取得（初期はJSONファイル、将来的にデータベース移行可能な構造）

## 主要機能

### 1. テキスト読解機能

- パーリ語の主要な経典テキストの表示
- テキスト全体にカタカナフリガナを表示
- 和訳の表示（オプションで表示/非表示を切り替え可能）
- 各単語のホバー/クリックで詳細情報を表示：
  - カタカナフリガナ
  - 和訳
  - 英訳
- テキストの選択範囲読み上げ
- 読みやすいフォントとレイアウト

### 2. 音声読み上げ機能

- テキスト全体の読み上げ
- 選択範囲の読み上げ
- 再生速度の調整
- 一時停止・再開機能

### 3. 管理画面

- パーリ語テキストの追加・編集・削除
- 辞書データ（単語と翻訳）の追加・編集・削除
- シンプルなCRUDインターフェース

## プロジェクト構造

```
survey-multi-agent-1/
├── app/                          # Next.js App Router
│   ├── page.tsx                 # ホームページ（テキスト一覧）
│   ├── reading/[id]/page.tsx    # テキスト読解ページ
│   ├── admin/                   # 管理画面
│   │   ├── page.tsx            # 管理画面トップ
│   │   ├── texts/page.tsx      # テキスト管理
│   │   └── dictionary/page.tsx # 辞書管理
│   └── api/                     # API Routes（データ取得のエンドポイント）
│       ├── texts/route.ts      # テキストCRUD API
│       └── dictionary/route.ts # 辞書CRUD API
├── components/                   # Reactコンポーネント
│   ├── ui/                      # shadcn/uiコンポーネント
│   ├── TextReader.tsx          # テキスト読解コンポーネント
│   ├── WordTooltip.tsx         # 単語詳細情報ツールチップ（カタカナ、和訳、英訳）
│   ├── FuriganaDisplay.tsx     # フリガナ表示コンポーネント
│   ├── AudioPlayer.tsx         # 音声読み上げコントロール
│   └── AdminForm.tsx           # 管理画面フォーム
├── lib/                         # ユーティリティ
│   ├── api/                     # API層（データ取得の抽象化）
│   │   ├── texts.ts            # テキストデータ取得API
│   │   └── dictionary.ts       # 辞書データ取得API
│   ├── data/                    # データアクセス層（実装詳細）
│   │   ├── file-storage.ts     # ファイルベース実装（初期）
│   │   └── database.ts         # データベース実装（将来的）
│   ├── dictionary.ts           # 辞書検索ロジック（多言語対応）
│   ├── katakana.ts             # カタカナ変換ロジック
│   └── tts.ts                  # 音声読み上げロジック
├── data/                        # データファイル（初期実装）
│   ├── sutta.json              # テキストデータ
│   └── dictionary/             # 辞書データ（アルファベット毎に分割）
│       ├── a.json
│       ├── b.json
│       └── ...
└── types/                       # TypeScript型定義
    └── index.ts                # 共通型定義
```

## データ構造

### テキストデータ (`sutta.json`)

```typescript
{
  id: string;
  title: string;
  content: string;  // パーリ語テキスト
  katakana?: string;  // カタカナフリガナ（テキスト全体）
  translation?: string;  // 日本語訳（オプション）
  source?: string;  // 経典の出典情報
  createdAt: string;
  updatedAt: string;
}
```

### 辞書データ (`dictionary/*.json`)

辞書データは単語の最初の文字（アルファベット）毎に分割され、`data/dictionary/` ディレクトリ配下に配置されています。
例: `dictionary/a.json`, `dictionary/b.json`, ..., `dictionary/s.json`, etc.

```typescript
{
  word: string;  // パーリ語単語
  katakana: string;  // カタカナフリガナ
  translations: {
    ja: string;  // 日本語訳
    en: string;  // 英語訳
    th?: string;  // タイ語訳（将来的な拡張）
    // その他の言語も将来的に追加可能
  };
  pronunciation?: string;  // 発音記号（IPA等）
  partOfSpeech?: string;  // 品詞
  examples?: string[];  // 用例
}
```

## 実装の優先順位

1. **Phase 1: 基本構造**

   - Bunを使用したNext.jsプロジェクトのセットアップ
   - shadcn/uiのセットアップとコンポーネント導入
   - API層の設計と実装（データアクセス層の抽象化）
   - 基本的なレイアウトとナビゲーション
   - データファイルの作成とAPI層経由での読み込み

2. **Phase 2: テキスト読解機能**

   - テキスト表示コンポーネント
   - カタカナフリガナの表示機能
   - 単語の詳細情報ツールチップ（カタカナ、和訳、英訳）
   - 和訳の表示/非表示切り替え機能
   - 基本的なスタイリング

3. **Phase 3: 音声読み上げ**

   - Web Speech APIの統合
   - 音声コントロールUI
   - 選択範囲読み上げ

4. **Phase 4: 管理画面**

   - テキスト管理CRUD
   - 辞書管理CRUD
   - フォームバリデーション

5. **Phase 5: 機能拡張**

   - 検索機能
   - お気に入り機能
   - 学習進捗の記録（オプション）

## UIデザイン方針

- **ミニマルデザイン**: 余計な装飾を排除し、テキストに集中できるUI
- **読みやすさ**: パーリ語フォントの最適化、適切な行間と余白
- **アクセシビリティ**: キーボード操作対応、コントラスト比の確保
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

## 技術的な考慮事項

- **ランタイム**: Bunを使用することで、高速なパフォーマンスとモダンなJavaScript/TypeScript機能を活用
- **UIコンポーネント**: shadcn/uiを使用して、アクセシブルでカスタマイズ可能なUIコンポーネントを構築
- **API層の設計**: データ取得は必ずAPI層（`lib/api/`）を通じて行い、データアクセス層（`lib/data/`）の実装を抽象化。これにより、JSONファイルからデータベースへの移行が容易になる
- **データアクセス層**: 初期実装はファイルベース（`file-storage.ts`）、将来的にデータベース実装（`database.ts`）に切り替え可能なインターフェース設計
- **音声読み上げ**: ブラウザのWeb Speech APIを使用（Chrome/Edge対応）。パーリ語の正確な発音には外部TTS APIの検討も必要
- **データ永続化**: 初期はJSONファイル、将来的にSQLiteやPostgreSQLへの移行を想定（API層を通じて切り替え）
- **パフォーマンス**: 大きなテキストファイルの分割読み込み、辞書のインデックス化
- **多言語対応**: 辞書データ構造を拡張可能に設計し、タイ語など他言語の翻訳を後から追加できるようにする
- **カタカナ変換**: パーリ語からカタカナフリガナへの自動変換機能を実装（必要に応じて辞書データに保存）

## 実装タスク

1. Bunを使用したNext.jsプロジェクトのセットアップ（TypeScript、Tailwind CSS、必要な依存関係のインストール）
2. shadcn/uiのセットアップと初期コンポーネントの導入
3. TypeScript型定義の作成（テキスト、辞書データの型）
4. API層の設計と実装（データアクセス層のインターフェース定義）
5. データアクセス層の実装（ファイルベース実装）
6. データファイル構造の作成（sutta.json、アルファベット毎に分割されたdictionary/*.jsonの初期データ）
7. API Routesの実装（データの読み書き、API層を経由）
8. 基本レイアウトとナビゲーションの実装（shadcn/uiコンポーネント使用）
9. テキスト読解コンポーネントの実装（テキスト表示、単語ツールチップ）
10. 音声読み上げ機能の実装（Web Speech API統合、コントロールUI）
11. 管理画面の実装（テキスト・辞書のCRUD機能、shadcn/uiフォーム使用）
12. ミニマルデザインのスタイリング（Tailwind CSS）
13. 基本的な動作確認とテスト

